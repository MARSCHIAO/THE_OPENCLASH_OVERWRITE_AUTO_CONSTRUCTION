# ==========================================================
# OpenClash 覆写配置文件 - Smart 智能模式
# 来源: external / Clash
# Provider数量: 1
# 特性: 自动选择最优节点
# ==========================================================

[General]
CORE_TYPE = Smart
CONFIG_FILE = /etc/openclash/config/Clash.yaml

# DNS 设置
ENABLE_REDIRECT_DNS = 1
ENABLE_CUSTOM_DNS = 0
APPEND_WAN_DNS = 1
STORE_FAKEIP = 1
CUSTOM_FAKEIP_FILTER = 1
CUSTOM_FAKEIP_FILTER_MODE = blacklist
FAKEIP_RANGE = 198.18.0.1/16

# IPv6
IPV6_ENABLE = 1
IPV6_DNS = 1
ENABLE_V6_UDP_PROXY = 1

# 代理模式
EN_MODE = fake-ip
ENABLE_UDP_PROXY = 1
ROUTER_SELF_PROXY = 1
PROXY_MODE = rule

# Smart 模式设置
AUTO_SMART_SWITCH = 1
SMART_STRATEGY = sticky-sessions
SMART_ENABLE_LGBM = 0
SMART_POLICY_PRIORITY = Premium:0.9;SG:1.3;HK:1.5
SMART_COLLECT = 1
SMART_COLLECT_SIZE = 500
SMART_COLLECT_RATE = 1

# 订阅信息
SUB_INFO_URL = $EN_KEY

# 下载配置
DOWNLOAD_FILE = url=https://raw.githubusercontent.com/MARSCHIAO/openclash_config_generator/main/processed_configs/external/General_Config/ClashConnectRules/Clash.yaml, path=/etc/openclash/config/Clash.yaml, cron=0 6 * * *, force=true

RESTART = true

[Overwrite]
# 更新订阅链接
ruby_edit "$CONFIG_FILE" "['proxy-providers']['all-proxies']['url']" "$EN_KEY"
